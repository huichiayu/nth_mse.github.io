
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Molecular dynamics hands-on Python coding practices &#8212; MSE 590400 Course Website</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'daily/Day-04/MolecularDynamics_singlePhase_student';</script>
    <link rel="icon" href="../../_static/Spartan_2.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Day 5" href="../../section_files/day_5.html" />
    <link rel="prev" title="Day 4" href="../../section_files/day_4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/Spartan_2.png" class="logo__image only-light" alt="MSE 590400 Course Website - Home"/>
    <script>document.write(`<img src="../../_static/Spartan_2.png" class="logo__image only-dark" alt="MSE 590400 Course Website - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Materials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../course_materials/MSE590400_Syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course_materials/MSE590400_Calendar.html">Schedule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course_materials/SoftwareSetupGuide_NTHU.html">Software Setup Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course_materials/MSE590400_AI_policy.html">Generative AI Policy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Semester Project</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../course_materials/SemesterProjectDetails_NTHU.html">Semester Project Details</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quiz/Exam</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../course_materials/Quiz_NTHU.html">MSE 590400 - Quiz/Exam Details</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Daily Content</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../section_files/day_1.html">Day 1</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../section_files/day_2.html">Day 2</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Day-02/Demo_EnergyFunctional.html">Demonstration of energy functional</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../section_files/day_3.html">Day 3</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Day-03/LJ_potent.html">Lennard-Jones potential</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../section_files/day_4.html">Day 4</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Molecular dynamics hands-on Python coding practices</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../section_files/day_5.html">Day 5</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Homework</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://raw.githubusercontent.com/huichiayu/cmse_202_802/main/MSE590/MSE590400_HW1_v1.pdf">Homework 1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.dropbox.com/request/w4urBdsmgnrh09diBHlx">Upload HW01 assignment</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/daily/Day-04/MolecularDynamics_singlePhase_student.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Molecular dynamics hands-on Python coding practices</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#put-your-name-here"><p style="text-align: right;"> ✅ <strong>Put your name here</strong> </p></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-build-containers-to-store-data">Part 1: build containers to store data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-1-initial-atomic-positions-velocities-and-accelerations">Part 1.1: Initial atomic positions, velocities, and accelerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-2-calculate-and-store-relative-vectors-and-distances-between-every-atom-pair">Part 1.2: Calculate and store relative vectors and distances between every atom pair.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-3-build-arrays-to-store-interatomic-forces-and-calculate-the-quantities">Part 1.3: Build arrays to store interatomic forces and calculate the quantities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-time-stepping">Part 2: Time stepping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-1">Part 2.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-2">Part 2.2</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="molecular-dynamics-hands-on-python-coding-practices">
<h1>Molecular dynamics hands-on Python coding practices<a class="headerlink" href="#molecular-dynamics-hands-on-python-coding-practices" title="Link to this heading">#</a></h1>
<p>This Jupyter Notebook file serves as a gateway to enter the realm of Python programming and molecular dynamics. We’ll break down the basic MD loop to several code cells, step-by-step. The main purpose of this coding assignment is to horn your Python programming skills. The first part will be creating multiple arrays, as containers, to store atoms’ information such as positions, velocity, acceleration, interatomic relative position vector, forces, etc. The second part will be run time iterations to calculate atomic foreces, accelerations, and update atomic positions. Note that the material parameters are arbitrarily set up. You’ll need to use realistic parameters if you want to simulate a real system.</p>
<p>by Hui-Chia Yu, 2025</p>
<hr class="docutils" />
<section id="put-your-name-here">
<h2><p style="text-align: right;"> ✅ <strong>Put your name here</strong> </p><a class="headerlink" href="#put-your-name-here" title="Link to this heading">#</a></h2>
<hr class="docutils" />
</section>
<section id="part-1-build-containers-to-store-data">
<h2>Part 1: build containers to store data<a class="headerlink" href="#part-1-build-containers-to-store-data" title="Link to this heading">#</a></h2>
<section id="part-1-1-initial-atomic-positions-velocities-and-accelerations">
<h3>Part 1.1: Initial atomic positions, velocities, and accelerations<a class="headerlink" href="#part-1-1-initial-atomic-positions-velocities-and-accelerations" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>First, we’ll create three containers to store atoms’ postion vectors, velocity vectors, and acceleration vectors. See the illustraion below. We’ll use numpy array for these containers. (Python has many different contrainers; for example, list, dictionary, tuple, set, etc. They have diferent properties and usages. We’re not going over them today.) Numpy arrays are created to mimic the arrays in Matlab and they could be used in a similar way.</p></li>
<li><p>Python is an open-source software package. There are tons of libraries that are created by other developers and they are shared openly via PyPI system. Those libraries are made following standard software sturcture and documentation practices. New users can go to resspective git site and git page to get familiar with the software libraries. For example, <a class="reference external" href="https://numpy.org">https://numpy.org.</a></p></li>
</ul>
<div align="center">
<img src="https://i.ibb.co/HDcbFjKm/arrays.png" width="260">
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s set up materials parameters, such as atomic mass, epsilon, etc.</span>
<span class="c1"># These parameters are set up arbitrarily. For real MD simulations,</span>
<span class="c1"># you will need to input realistic materials parameters.</span>

<span class="n">ma</span> <span class="o">=</span> <span class="mf">0.5</span>         <span class="c1"># &lt;-- mass</span>
<span class="n">rm</span> <span class="o">=</span> <span class="mf">0.1</span>         <span class="c1"># &lt;-- reference radius</span>
<span class="n">eps</span> <span class="o">=</span> <span class="mf">0.25</span>       <span class="c1"># &lt;-- coefficient for energy well</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">rm</span><span class="o">*</span><span class="mf">1.12246</span>  <span class="c1"># &lt;-- equilibrium radius</span>


<span class="c1"># compuational box size</span>
<span class="n">Lx</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">Ly</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="c1"># we first import numpy library</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># set up the number of atoms</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">64</span>

<span class="c1"># create position, velocity, and acceleration arrays</span>
<span class="n">Pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">Vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># &lt;-- random initial velocity</span>
<span class="n">Vel</span> <span class="o">*=</span> <span class="mf">0.001</span> 
<span class="n">Acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># &lt;-- random initial acceleration </span>
<span class="n">Acc</span> <span class="o">*=</span> <span class="mf">0.0001</span> 

<span class="c1"># set up initial atom positions. Let&#39;s make a 8x8 configuration</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>           <span class="c1"># &lt;-- note that default Python loop goes from 0 to n-1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>       <span class="c1"># &lt;-- note indent is what Python recognizes nest loop</span>
        <span class="n">Pos</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">*</span><span class="n">r0</span> <span class="o">+</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">r0</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span> <span class="c1"># &lt;-- add some randomness</span>
        <span class="n">Pos</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">8</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">r0</span> <span class="o">+</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">r0</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>


<span class="c1"># save the initial atomic positions</span>
<span class="n">Pos_pr</span> <span class="o">=</span> <span class="n">Pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">Vel_pr</span> <span class="o">=</span> <span class="n">Vel</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">Acc_pr</span> <span class="o">=</span> <span class="n">Acc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Let’s visualize the initial atom configuration in the cell below.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import matplotlib library, which is built to</span>
<span class="c1"># mimic Matlab&#39;s plotting functionality</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  

<span class="c1"># Plot results</span>
<span class="c1"># plt.scatter(Pos[:, 0], Pos[:, 1], c=&#39;b&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x Position&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y Position&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Particle Positions&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-1-2-calculate-and-store-relative-vectors-and-distances-between-every-atom-pair">
<h3>Part 1.2: Calculate and store relative vectors and distances between every atom pair.<a class="headerlink" href="#part-1-2-calculate-and-store-relative-vectors-and-distances-between-every-atom-pair" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Let’s create a 3d array to store the relative position vectors between atom pairs.</strong> Since we have N atoms, we’ll make a NxNx3 array; for instance, a <code class="docutils literal notranslate"><span class="pre">dst[i,j,k]</span></code> array, where we use index i for the atom of interest, index j for the neighboring atoms, k = 0 and 1 for the <span class="math notranslate nohighlight">\(x\)</span> component (<span class="math notranslate nohighlight">\(\Delta x_{ij}\)</span>) and <span class="math notranslate nohighlight">\(y\)</span> component (<span class="math notranslate nohighlight">\(\Delta y_{ij}\)</span>) of the relative vector, respectively, and k = 2 for the distance between two atoms (<span class="math notranslate nohighlight">\(r_{ij}\)</span>).
$<span class="math notranslate nohighlight">\(\Delta x_{ij} = x_j - x_i,~~~~\Delta x_{ji} = -\Delta x_{ij}\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\Delta y_{ij} = y_j - y_i,~~~~\Delta y_{ji} = -\Delta y_{ij}\)</span>$</p></li>
<li><p>For periodic cells, we need to consider the mirroring neighbor atoms from the neighboring cell. See the figure below for illustration.</p></li>
</ul>
<div align="center">
<img src="https://i.ibb.co/60vv5VJ8/MD-Instruction-Note1-A.jpg" width="280">
</div>
Along the $x$ direction, we'll pick the closest neighboring atom using $$\Delta x_{ij} = \min(|\Delta x_{ij}|, |\Delta x_{ij}+L_x|, |\Delta x_{ij}-L_x|).$$
Similarly, in the $y$ direction, we'll take $$\Delta y _{ij} = \min(|\Delta y_{ij}|, |\Delta y_{ij}+L_y|, |\Delta y_{ij}-L_y|)$$ for the closest atom (in the surrounding repeated cell).
<ul class="simple">
<li><p>The distance between two atoms is calculated using:
$<span class="math notranslate nohighlight">\(r_{ij} = \sqrt{\Delta x_{ij}^2 + \Delta y_{ij}^2},~~~~r_{ji} =r_{ij}.\)</span>$</p></li>
<li><p>Since atoms are relative to each other in opposite direction. Thus, we only need to calculate half of the number of atom pairs. For example, calculate the upper right triagnle of the whole data set and mirror the values, with a negative sign, to the lower left triangle. See the figure below for illustration.</p></li>
</ul>
<div align="center">
<img src="https://i.ibb.co/hSW4t4Z/MD-Instruction-Note-array1-A.jpg" width="800">
</div>
<p><strong>Create the distance array as described above in the code cell below.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a 3d array to store relative positions between atom pairs.</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># fill the ?? in the code</span>
<span class="n">dst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="err">??</span><span class="p">,</span><span class="err">??</span><span class="p">,</span><span class="err">??</span><span class="p">))</span>

<span class="c1"># loop over atoms and neighbors to calculate interatomic distances</span>
<span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">at</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>  <span class="c1"># &lt;-- calculate only the upper right triangle</span>
        <span class="n">dx_c</span> <span class="o">=</span> <span class="o">??</span>
        <span class="n">dx_w</span> <span class="o">=</span> <span class="n">dx_c</span> <span class="o">-</span> <span class="n">Lx</span>
        <span class="n">dx_e</span> <span class="o">=</span> <span class="n">dx_c</span> <span class="o">+</span> <span class="n">Lx</span>
        <span class="c1"># x component</span>
        <span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">dx_c</span><span class="p">,</span> <span class="n">dx_w</span><span class="p">,</span> <span class="n">dx_e</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span>

        <span class="n">dy_c</span> <span class="o">=</span> <span class="o">??</span>
        <span class="n">dy_s</span> <span class="o">=</span> <span class="o">??</span>
        <span class="n">dy_n</span> <span class="o">=</span> <span class="o">??</span>
        <span class="c1"># y component</span>
        <span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">dy_c</span><span class="p">,</span> <span class="n">dy_s</span><span class="p">,</span> <span class="n">dy_n</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span>

        <span class="c1"># distance between 2 atoms</span>
        <span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dst</span><span class="p">[</span><span class="err">??</span><span class="p">,</span><span class="err">??</span><span class="p">,</span><span class="err">??</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dst</span><span class="p">[</span><span class="err">??</span><span class="p">,</span><span class="err">??</span><span class="p">,</span><span class="err">??</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="c1"># lower left triangle</span>
        <span class="n">dst</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="err">??</span><span class="p">,</span><span class="err">??</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dst</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="err">??</span><span class="p">,</span><span class="err">??</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dst</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span>  <span class="n">dst</span><span class="p">[</span><span class="err">??</span><span class="p">,</span><span class="err">??</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>            
</pre></div>
</div>
</div>
</div>
</section>
<section id="part-1-3-build-arrays-to-store-interatomic-forces-and-calculate-the-quantities">
<h3>Part 1.3: Build arrays to store interatomic forces and calculate the quantities<a class="headerlink" href="#part-1-3-build-arrays-to-store-interatomic-forces-and-calculate-the-quantities" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We then make another 3d array, with the size of NxNx2, to store interatomic forces between atom pairs. Let’s use <code class="docutils literal notranslate"><span class="pre">Fij[i,j,k]</span></code>, where k = 0 and 1 are for the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> components of the forces. See the illustraion below.</p></li>
</ul>
<div align="center">
<img src="https://i.ibb.co/HLdnWWpf/MD-Instruction-Note-Fij.jpg" width="580">
</div>
<ul class="simple">
<li><p>The interatomic forces are calculated using $<span class="math notranslate nohighlight">\(\vec{f}_{ij} = -\frac{\vec{r}_{ij}}{r_{ij}}  \frac{24 \varepsilon}{r_m} \bigg[2 \bigg(\frac{r_m}{r_{ij}}\bigg)^{13} - \bigg(\frac{r_m}{r_{ij}}\bigg)^7 \bigg],\)</span><span class="math notranslate nohighlight">\( where \)</span>\vec{r}<em>{ij} = (\Delta x</em>{ij}, \Delta y_{ij}).$</p></li>
<li><p>We will create anthor 2d array of Nx2 size to store the vector of the total force on each atom. This array will be similar to the position-vector array created earlier. Let’s use <code class="docutils literal notranslate"><span class="pre">Fi_v[i,j]</span></code>, where i is the label of atoms, and j is the index for <span class="math notranslate nohighlight">\(x\)</span> or <span class="math notranslate nohighlight">\(y\)</span> components. The total force vector is obtained by summing the respective row in the <span class="math notranslate nohighlight">\(\vec{f}_{ij}\)</span> array:
$<span class="math notranslate nohighlight">\(\vec{f}_i = \sum_{j}^N\vec{f}_{ij}.\)</span>$ See the figure below for illustration.</p></li>
<li><p>Here, we also set a cutoff radius to be <span class="math notranslate nohighlight">\(r_{cut} = 3r_0\)</span>, outside the cutoff range, the interatomic forces are ignored.</p></li>
<li><p>Again, we only need to calculate the upper right triangle and mirror the values to the low triangle of the data array.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># build Fij and Fi_v array, and calculate the values of the entries.</span>

<span class="c1"># fill the ?? in the code</span>

<span class="n">Fij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="err">??</span><span class="p">))</span>
<span class="n">r_cut</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">r0</span>

<span class="c1"># loop over atoms and neighbors to calculate interatomic forecs</span>
<span class="n">Fij</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">at</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="err">??</span> <span class="o">&lt;</span> <span class="n">r_cut</span><span class="p">:</span>

            <span class="n">dUdr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="n">eps</span><span class="o">/</span><span class="n">rm</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="err">??</span><span class="p">)</span><span class="o">**</span><span class="mi">13</span> <span class="o">-</span> <span class="p">(</span><span class="err">??</span><span class="p">)</span><span class="o">**</span><span class="mi">7</span><span class="p">)</span>
            <span class="c1"># x component</span>
            <span class="n">Fij</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dUdr</span>
            <span class="n">Fij</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Fij</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="c1"># y component</span>
            <span class="n">Fij</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>
            <span class="n">Fij</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>            


<span class="c1"># sum up the interatomic forces to get the total force on the atom of interest.</span>
<span class="n">Fi_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">Fi_v</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">Fi_v</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>
    <span class="n">Fi_v</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>
</pre></div>
</div>
</div>
</div>
<p>When you arrive this part of the code, all the necessary containers should be successfully created.</p>
<hr class="docutils" />
</section>
</section>
<section id="part-2-time-stepping">
<h2>Part 2: Time stepping<a class="headerlink" href="#part-2-time-stepping" title="Link to this heading">#</a></h2>
<section id="part-2-1">
<h3>Part 2.1<a class="headerlink" href="#part-2-1" title="Link to this heading">#</a></h3>
<p>In this part, we’ll put those arrays above to make the time stepping simulations to update atoms’ positions iteratively. Following the procedure,</p>
<ul class="simple">
<li><p>Calculate interatomic distances between pairs.</p></li>
<li><p>Calculate interatomic forces between pairs. Note we only calculate those atoms within the cutoff radius (<span class="math notranslate nohighlight">\(r_{cut}\)</span>). We keep the cutoff radius to be three times equilibrium distance (<span class="math notranslate nohighlight">\(r_{cut} = 3r_0 = 3\times 1.12246 \cdot r_m\)</span>). For neighbors outside that range, the interaction forces are zero.</p></li>
<li><p>Calculate total force (<code class="docutils literal notranslate"><span class="pre">Fi_v</span></code>) of each atom by summing each row of the <code class="docutils literal notranslate"><span class="pre">Fij</span></code> array.</p></li>
<li><p>Use Newton’s law to calculate acceleration of each atom: $<span class="math notranslate nohighlight">\(\vec{a}_i = \frac{\vec{f}_i}{m}.\)</span>$</p></li>
<li><p>We will try a simple time method first. Use Euler method:
$<span class="math notranslate nohighlight">\(\vec{r}(t_{n+1}) = \vec{r}(t_{n})+ \vec{v}(t_{n})\cdot \Delta t\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\vec{v}(t_{n+1}) = \vec{v}(t_{n})+ \vec{a}(t_{n})\cdot \Delta t\)</span>$ to update atoms positions and velocities.</p></li>
<li><p>Consider the periodic boundary conditions: If an atom leaves the computational box from one boundary, it must re-enter the box from the opposite boundary. See the figure below for illustration.</p></li>
</ul>
<div align="center">
<img src="https://i.ibb.co/gbHx7PMs/MD-Instruction-Note7.jpg" width="260">
</div>
$$\text{if} ~~ x_{i}(t+\Delta t) < 0, ~~\text{then} ~~x_{i}(t+\Delta t) = x_{i}(t+\Delta t)  + L_x$$
$$\text{if} ~~ x_{i}(t+\Delta t) > L_x, ~~\text{then} ~~x_{i}(t+\Delta t) = x_{i}(t+\Delta t) - L_x$$
$$\text{if} ~~ y_{i}(t+\Delta t) < 0, ~~\text{then} ~~y_{i}(t+\Delta t) = y_{i}(t+\Delta t)  + L_y$$
$$\text{if} ~~ y_{i}(t+\Delta t) > L_y, ~~\text{then} ~~y_{i}(t+\Delta t) = y_{i}(t+\Delta t) - L_y$$
<p><strong>Use the code cell to make the time simulation.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries for plotting</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Initialization before the loop</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">)</span>

<span class="c1"># set up number of time steps and time step size</span>
<span class="n">nstep</span> <span class="o">=</span> <span class="mi">10001</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.00005</span>
<span class="n">r_cut</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">r0</span>


<span class="c1"># get initial positions from Part 1</span>
<span class="n">Pos</span> <span class="o">=</span> <span class="n">Pos_pr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> 
<span class="n">Vel</span> <span class="o">=</span> <span class="n">Vel_pr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">Acc</span> <span class="o">=</span> <span class="n">Acc_pr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


<span class="c1"># fill the ?? in the code below</span>


<span class="n">tm</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Simulation loop</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nstep</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>

    <span class="c1"># Periodic boundary conditions</span>
    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="c1"># in x direction</span>
        <span class="k">if</span> <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">Lx</span>
        <span class="k">if</span> <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Lx</span><span class="p">:</span>
            <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>

        <span class="c1"># in y direction</span>
        <span class="k">if</span> <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>
        <span class="k">if</span> <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Lx</span><span class="p">:</span>
            <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>
            
    <span class="c1"># Calculate inter-atom distances with periodic boundaries</span>
    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">at</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
            <span class="n">dx_c</span> <span class="o">=</span> <span class="o">??</span>
            <span class="n">dx_w</span> <span class="o">=</span> <span class="o">??</span>
            <span class="n">dx_e</span> <span class="o">=</span> <span class="o">??</span>

            <span class="n">dy_c</span> <span class="o">=</span> <span class="o">??</span>
            <span class="n">dy_s</span> <span class="o">=</span> <span class="o">??</span>
            <span class="n">dy_n</span> <span class="o">=</span> <span class="o">??</span>

            <span class="c1"># X component</span>
            <span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">dx_c</span><span class="p">,</span> <span class="n">dx_w</span><span class="p">,</span> <span class="n">dx_e</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span>
            <span class="n">dst</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># Y component</span>
            <span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">dy_c</span><span class="p">,</span> <span class="n">dy_s</span><span class="p">,</span> <span class="n">dy_n</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span>
            <span class="n">dst</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># Inter-atom distance</span>
            <span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="err">??</span><span class="p">)</span>
            <span class="n">dst</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Calculate force</span>
    <span class="n">Fij</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">at</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">r_cut</span><span class="p">:</span>
                <span class="n">dUdr</span> <span class="o">=</span> <span class="o">??</span>
                
                <span class="n">Fij</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>
                <span class="n">Fij</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>

                <span class="n">Fij</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Fij</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">Fij</span><span class="p">[</span><span class="n">ne</span><span class="p">,</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Fij</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Calculate total force of each atom</span>
    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">Fi_v</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>
        <span class="n">Fi_v</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">??</span>
    
    <span class="c1"># calculate acceleration of each atom</span>
    <span class="c1"># Acc = Fi_v/ma</span>
    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> 
        <span class="n">Acc</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fi_v</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">ma</span>
        <span class="n">Acc</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fi_v</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">ma</span>   
        
    <span class="c1"># Update positions</span>
    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> 
        <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Vel</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Vel</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span>

    
    <span class="c1"># Update velocity</span>
    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> 
        <span class="n">Vel</span><span class="p">[</span><span class="n">at</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Acc</span><span class="p">[</span><span class="n">at</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">Vel</span><span class="p">[</span><span class="n">at</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">Acc</span><span class="p">[</span><span class="n">at</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c1"># print(X_Y)</span>

    <span class="c1"># Elapsed time</span>
    <span class="n">tm</span> <span class="o">+=</span> <span class="n">dt</span>

    <span class="c1"># Visualization</span>
    <span class="k">if</span> <span class="n">it</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
   
        <span class="c1"># Animaiton part (dosn&#39;t change)</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Clear output for dynamic display</span>
        <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>            <span class="c1"># Reset display</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>             <span class="c1"># Prevent overlapping and layered plots</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.0002</span><span class="p">)</span>         <span class="c1"># Sleep for half a second to slow down the animation</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="part-2-2">
<h3>Part 2.2<a class="headerlink" href="#part-2-2" title="Link to this heading">#</a></h3>
<p>Now, <strong>let’s use Verlet time scheme.</strong></p>
<ul class="simple">
<li><p>At the initial step: $<span class="math notranslate nohighlight">\(\vec{r}(t_1) = \vec{r}(t_0) + \vec{v}(t_0)\cdot \Delta t + \frac{1}{2}\vec{a}(t_0)\cdot \Delta t^2.\)</span><span class="math notranslate nohighlight">\( Now, since there are position arrays: one for \)</span>t_1<span class="math notranslate nohighlight">\( and the other for \)</span>t_0$, we’ll need to create another position vector to store the position in the previous time step.</p></li>
<li><ul>
<li><p>Use Verlet’s method to update atomic positions: $<span class="math notranslate nohighlight">\(\vec{r}(t_{n+1}) = 2\vec{r}(t_{n}) - \vec{r}(t_{n-1}) + \vec{a}(t_{n})\cdot \Delta t^2  \)</span>$</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries for plotting</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Initialization before the loop</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">)</span>


<span class="c1"># set up number of time steps and time step size</span>
<span class="n">nstep</span> <span class="o">=</span> <span class="mi">10001</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.00005</span>
<span class="n">r_cut</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">r0</span>


<span class="c1"># get initial positions from Part 1</span>
<span class="n">Pos</span> <span class="o">=</span> <span class="n">Pos_pr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> 
<span class="n">Vel</span> <span class="o">=</span> <span class="n">Vel_pr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">Acc</span> <span class="o">=</span> <span class="n">Acc_pr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pos_pr</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">Vel</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Acc</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="o">**</span><span class="mi">2</span>
    
<span class="n">Pos_c</span> <span class="o">=</span> <span class="n">Pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">Pos_p</span> <span class="o">=</span> <span class="n">Pos_pr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">tm</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">cnt</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># copy your functioning code in the cell above to the respective part of </span>
<span class="c1"># this code.</span>
<span class="c1"># Simulation loop</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nstep</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>

    <span class="c1"># Periodic boundary conditions</span>
 
            
    <span class="c1"># Calculate inter-atom distances with periodic boundaries</span>
 

    <span class="c1"># Calculate force</span>
    <span class="n">Fij</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ne</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">at</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">dst</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="n">ne</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">r_cut</span><span class="p">:</span>


    <span class="c1"># Calculate total force of each atom</span>
    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>

    
    <span class="c1"># calculate acceleration of each atom</span>
    <span class="c1"># Acc = Fi_v/ma</span>
    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> 
        <span class="n">Acc</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fi_v</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">ma</span>
        <span class="n">Acc</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Fi_v</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">ma</span>   
        
    <span class="c1"># Update positions</span>
    <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> 
        <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="err">??</span> <span class="o">-</span> <span class="err">??</span> <span class="o">+</span> <span class="n">Acc</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">Pos</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="err">??</span> <span class="o">-</span> <span class="err">??</span> <span class="o">+</span> <span class="n">Acc</span><span class="p">[</span><span class="n">at</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dt</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">Pos_p</span> <span class="o">=</span> <span class="n">Pos_c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">Pos_c</span> <span class="o">=</span> <span class="n">Pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># print(X_Y)</span>

    <span class="c1"># Elapsed time</span>
    <span class="n">tm</span> <span class="o">+=</span> <span class="n">dt</span>

    <span class="c1"># Visualization</span>
    <span class="k">if</span> <span class="n">it</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;bo&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">Lx</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Ly</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>

   
        <span class="c1"># Animaiton part (dosn&#39;t change)</span>
        <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Clear output for dynamic display</span>
        <span class="n">display</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>            <span class="c1"># Reset display</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>             <span class="c1"># Prevent overlapping and layered plots</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.0002</span><span class="p">)</span>         <span class="c1"># Sleep for half a second to slow down the animation</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Upload you final copy to the drop box on the course website. Lab 1 coding assignment.</strong>
DO NOT forget adding your name to the file name.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-base-py"
        },
        kernelOptions: {
            name: "conda-base-py",
            path: "./daily/Day-04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-base-py'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../section_files/day_4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Day 4</p>
      </div>
    </a>
    <a class="right-next"
       href="../../section_files/day_5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Day 5</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#put-your-name-here"><p style="text-align: right;"> ✅ <strong>Put your name here</strong> </p></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-build-containers-to-store-data">Part 1: build containers to store data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-1-initial-atomic-positions-velocities-and-accelerations">Part 1.1: Initial atomic positions, velocities, and accelerations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-2-calculate-and-store-relative-vectors-and-distances-between-every-atom-pair">Part 1.2: Calculate and store relative vectors and distances between every atom pair.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1-3-build-arrays-to-store-interatomic-forces-and-calculate-the-quantities">Part 1.3: Build arrays to store interatomic forces and calculate the quantities</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-time-stepping">Part 2: Time stepping</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-1">Part 2.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2-2">Part 2.2</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Hui-Chia Yu
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>